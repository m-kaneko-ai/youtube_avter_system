# 9. 管理ページ

## 基本情報

| 項目 | 内容 |
|-----|------|
| パス | `/admin` |
| 認証 | 必要 |
| ロール | Owner のみ |

## タブ構成

| タブ | 内容 |
|-----|------|
| ユーザー管理 | チームメンバー管理 |
| クライアント管理 | 外部クライアント管理 |
| システム設定 | 全体設定 |
| API連携 | 外部サービス連携 |

---

## タブ1: ユーザー管理

### ワイヤーフレーム

```
┌─────────────────────────────────────────────────────────────┐
│  [ユーザー管理] [クライアント管理] [システム設定] [API連携]   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ユーザー管理                               [+ ユーザー招待]  │
│                                                             │
│  チームメンバー (7名)                                        │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 名前           │ メール            │ ロール │ 状態 │ 操作│   │
│  ├────────────────┼──────────────────┼────────┼──────┼─────┤   │
│  │ 金子 光義      │ kaneko@...       │ Owner  │ 🟢   │ -   │   │
│  │ 田中 太郎      │ tanaka@...       │ Team   │ 🟢   │ ... │   │
│  │ 鈴木 花子      │ suzuki@...       │ Team   │ 🟢   │ ... │   │
│  │ 佐藤 次郎      │ sato@...         │ Team   │ 🟡   │ ... │   │
│  │ 山田 三郎      │ yamada@...       │ Team   │ 🟢   │ ... │   │
│  │ 高橋 四郎      │ takahashi@...    │ Team   │ 🟢   │ ... │   │
│  │ 伊藤 五郎      │ ito@...          │ Team   │ 🔴   │ ... │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  凡例: 🟢 アクティブ  🟡 招待中  🔴 無効                      │
│                                                             │
│  ─────────────────────────────────────────────────────      │
│                                                             │
│  アクティビティログ                                          │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 12/11 14:30 │ 田中 │ 企画作成「AI活用術」           │   │
│  │ 12/11 14:15 │ 鈴木 │ 動画公開「集客のコツ」         │   │
│  │ 12/11 13:45 │ 田中 │ 台本承認依頼                   │   │
│  │ 12/11 13:20 │ 金子 │ ナレッジ更新                   │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### ユーザー招待モーダル

```
┌─────────────────────────────────────────────────────────────┐
│  ユーザー招待                                       [×]      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  メールアドレス                                              │
│  [                                                      ]   │
│                                                             │
│  ロール                                                      │
│  ○ Team（動画制作・公開権限）                               │
│  ○ Viewer（閲覧のみ）                                       │
│                                                             │
│  招待メッセージ（任意）                                       │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ Creator Studio AIへようこそ！                        │   │
│  │ チームに参加してください。                           │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│                              [キャンセル] [招待を送信]       │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### ユーザー編集モーダル

```
┌─────────────────────────────────────────────────────────────┐
│  ユーザー編集: 田中 太郎                           [×]       │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  基本情報                                                    │
│  名前: 田中 太郎                                             │
│  メール: tanaka@example.com                                 │
│  参加日: 2025/11/15                                         │
│                                                             │
│  ロール                                                      │
│  [Team ▼]                                                   │
│                                                             │
│  アクセス権限                                                │
│  ☑ 企画作成・編集                                           │
│  ☑ 台本作成・編集                                           │
│  ☑ 動画制作                                                 │
│  ☑ 動画公開                                                 │
│  □ ナレッジ編集                                             │
│  □ 分析・レポート閲覧                                       │
│                                                             │
│  ─────────────────────────────────────────────────────      │
│                                                             │
│  危険な操作                                                  │
│  [アカウントを無効化] [削除]                                 │
│                                                             │
│                              [キャンセル] [保存]            │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## タブ2: クライアント管理

### ワイヤーフレーム

```
┌─────────────────────────────────────────────────────────────┐
│  [ユーザー管理] [クライアント管理] [システム設定] [API連携]   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  クライアント管理                           [+ クライアント追加]│
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 企業名         │ 担当者    │ プラン  │ 動画数 │ 状態 │ 操作│   │
│  ├────────────────┼──────────┼─────────┼────────┼──────┼─────┤   │
│  │ ABC株式会社    │ 山田様   │ Pro     │ 45/90  │ 🟢   │ ... │   │
│  │ XYZ合同会社    │ 佐々木様 │ Basic   │ 12/30  │ 🟢   │ ... │   │
│  │ DEFコンサル    │ 高田様   │ Pro     │ 0/90   │ 🟡   │ ... │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  凡例: 🟢 アクティブ  🟡 オンボーディング中  🔴 一時停止      │
│                                                             │
│  ─────────────────────────────────────────────────────      │
│                                                             │
│  今月のクライアントサマリー                                   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 総クライアント数: 3                                  │   │
│  │ アクティブ: 2    オンボーディング中: 1               │   │
│  │ 今月の動画制作数: 57本                               │   │
│  │ 月間売上: ¥450,000                                  │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### クライアント詳細モーダル

```
┌─────────────────────────────────────────────────────────────┐
│  クライアント詳細: ABC株式会社                     [×]       │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  基本情報                                                    │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 企業名: ABC株式会社                                  │   │
│  │ 担当者: 山田 太郎 様                                 │   │
│  │ メール: yamada@abc.co.jp                            │   │
│  │ 電話: 03-1234-5678                                  │   │
│  │ 契約開始: 2025/10/01                                │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  プラン情報                                                  │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ プラン: Pro                                          │   │
│  │ 月額: ¥150,000                                      │   │
│  │ 動画枠: 90本/月                                     │   │
│  │ 今月使用: 45本 (50%)                                │   │
│  │ ━━━━━━━━━━━━━━━━━━━━░░░░░░░░░░                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ナレッジ                                    [構築を開始]    │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ ナレッジ名: ABC社マーケティング戦略                  │   │
│  │ 構築状態: ✅ 完了                                    │   │
│  │ 最終更新: 2025/11/20                                │   │
│  │                                                      │   │
│  │ [ナレッジを表示] [再構築]                            │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  YouTube連携                                                │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ チャンネル: ABC公式チャンネル                        │   │
│  │ 登録者: 5,420人                                     │   │
│  │ 連携状態: ✅ 連携済み                                │   │
│  │                                                      │   │
│  │ [再認証] [連携解除]                                  │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│                              [編集] [契約終了]              │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## タブ3: システム設定

### ワイヤーフレーム

```
┌─────────────────────────────────────────────────────────────┐
│  [ユーザー管理] [クライアント管理] [システム設定] [API連携]   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  システム設定                                                │
│                                                             │
│  一般設定                                                    │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ アプリケーション名: [Creator Studio AI           ]   │   │
│  │ タイムゾーン: [Asia/Tokyo ▼]                        │   │
│  │ 言語: [日本語 ▼]                                    │   │
│  │ 日付形式: [YYYY/MM/DD ▼]                            │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ─────────────────────────────────────────────────────      │
│                                                             │
│  デフォルト設定                                              │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ デフォルト動画種別: [ショート動画 ▼]                 │   │
│  │ デフォルトボイス: [金子光義（メイン） ▼]             │   │
│  │ デフォルトアバター: [金子光義アバター ▼]             │   │
│  │ デフォルト背景: [オフィス風 ▼]                       │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ─────────────────────────────────────────────────────      │
│                                                             │
│  通知設定                                                    │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ ☑ 承認依頼の通知                                    │   │
│  │ ☑ 動画生成完了の通知                                │   │
│  │ ☑ 公開完了の通知                                    │   │
│  │ ☑ エラー発生の通知                                  │   │
│  │ □ 週次レポートの自動送信                            │   │
│  │                                                      │   │
│  │ 通知先メール: [kaneko@example.com               ]   │   │
│  │ Slack Webhook: [https://hooks.slack.com/...     ]   │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ─────────────────────────────────────────────────────      │
│                                                             │
│  目標設定                                                    │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 月間目標動画数: [120] 本                            │   │
│  │   ├ ショート動画: [90] 本                           │   │
│  │   └ 長尺動画: [30] 本                               │   │
│  │                                                      │   │
│  │ 週間公開スケジュール                                 │   │
│  │ □ 月  ☑ 火  ☑ 水  ☑ 木  ☑ 金  □ 土  □ 日        │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│                                               [保存]        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## タブ4: API連携

### ワイヤーフレーム

```
┌─────────────────────────────────────────────────────────────┐
│  [ユーザー管理] [クライアント管理] [システム設定] [API連携]   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  API連携設定                                                 │
│                                                             │
│  AI サービス                                                 │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                      │   │
│  │  Gemini API                                ✅ 連携中  │   │
│  │  API Key: ****************************1234           │   │
│  │  使用量: 1,234,567 tokens / 月                       │   │
│  │  [テスト] [更新]                                     │   │
│  │                                                      │   │
│  │  ─────────────────────────────────────────────────  │   │
│  │                                                      │   │
│  │  Claude API                                ✅ 連携中  │   │
│  │  API Key: ****************************5678           │   │
│  │  使用量: 567,890 tokens / 月                         │   │
│  │  [テスト] [更新]                                     │   │
│  │                                                      │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ─────────────────────────────────────────────────────      │
│                                                             │
│  動画生成サービス                                            │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                      │   │
│  │  HeyGen                                    ✅ 連携中  │   │
│  │  API Key: ****************************abcd           │   │
│  │  クレジット残高: 2,450 / 5,000                       │   │
│  │  ━━━━━━━━━━━━━━━━━━━━░░░░░░░░░░                     │   │
│  │  [テスト] [更新] [クレジット購入]                    │   │
│  │                                                      │   │
│  │  ─────────────────────────────────────────────────  │   │
│  │                                                      │   │
│  │  MiniMax Audio                             ✅ 連携中  │   │
│  │  API Key: ****************************efgh           │   │
│  │  使用量: 45.2 時間 / 100 時間                        │   │
│  │  [テスト] [更新]                                     │   │
│  │                                                      │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ─────────────────────────────────────────────────────      │
│                                                             │
│  プラットフォーム連携                                        │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                      │   │
│  │  YouTube Data API                          ✅ 連携中  │   │
│  │  プロジェクト: creator-studio-ai                     │   │
│  │  日次クォータ: 8,500 / 10,000 units                 │   │
│  │  [OAuth再認証] [設定]                                │   │
│  │                                                      │   │
│  │  ─────────────────────────────────────────────────  │   │
│  │                                                      │   │
│  │  TikTok API                               ⚠️ 未連携  │   │
│  │  [連携する]                                          │   │
│  │                                                      │   │
│  │  ─────────────────────────────────────────────────  │   │
│  │                                                      │   │
│  │  Instagram API                            ⚠️ 未連携  │   │
│  │  [連携する]                                          │   │
│  │                                                      │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ─────────────────────────────────────────────────────      │
│                                                             │
│  調査・分析サービス                                          │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                      │   │
│  │  Social Blade                              ✅ 連携中  │   │
│  │  API Key: ****************************ijkl           │   │
│  │  [テスト] [更新]                                     │   │
│  │                                                      │   │
│  │  ─────────────────────────────────────────────────  │   │
│  │                                                      │   │
│  │  SerpApi                                   ✅ 連携中  │   │
│  │  API Key: ****************************mnop           │   │
│  │  検索残: 850 / 1,000 回                             │   │
│  │  [テスト] [更新]                                     │   │
│  │                                                      │   │
│  │  ─────────────────────────────────────────────────  │   │
│  │                                                      │   │
│  │  Amazon PA-API                             ✅ 連携中  │   │
│  │  Access Key: ****************************qrst        │   │
│  │  [テスト] [更新]                                     │   │
│  │                                                      │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ─────────────────────────────────────────────────────      │
│                                                             │
│  画像生成サービス                                            │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                      │   │
│  │  Nano Banana Pro                           ✅ 連携中  │   │
│  │  API Key: ****************************uvwx           │   │
│  │  生成残: 450 / 1,000 枚                             │   │
│  │  [テスト] [更新]                                     │   │
│  │                                                      │   │
│  │  ─────────────────────────────────────────────────  │   │
│  │                                                      │   │
│  │  Veo (B-roll生成)                          ✅ 連携中  │   │
│  │  API Key: ****************************yzab           │   │
│  │  [テスト] [更新]                                     │   │
│  │                                                      │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### API設定モーダル

```
┌─────────────────────────────────────────────────────────────┐
│  API設定: Gemini API                               [×]      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  API Key                                                    │
│  [AIza...                                               ]   │
│  [👁 表示]                                                  │
│                                                             │
│  エンドポイント（オプション）                                │
│  [https://generativelanguage.googleapis.com/v1       ]     │
│                                                             │
│  モデル設定                                                  │
│  デフォルトモデル: [gemini-1.5-pro ▼]                       │
│  温度: [━━━━●━━━━━] 0.7                                     │
│  最大トークン: [8192                                 ]      │
│                                                             │
│  レート制限                                                  │
│  1分あたりリクエスト数: [60                          ]      │
│  1日あたりリクエスト数: [1500                        ]      │
│                                                             │
│  ─────────────────────────────────────────────────────      │
│                                                             │
│  接続テスト                                                  │
│  [テスト実行]                                               │
│                                                             │
│  最終テスト: 2025/12/11 14:30 - ✅ 成功                     │
│                                                             │
│                              [キャンセル] [保存]            │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 状態管理

```typescript
interface AdminState {
  activeTab: 'users' | 'clients' | 'settings' | 'api';
  users: {
    list: User[];
    selectedUser: User | null;
    activityLogs: ActivityLog[];
    isLoading: boolean;
  };
  clients: {
    list: Client[];
    selectedClient: Client | null;
    summary: ClientSummary;
    isLoading: boolean;
  };
  settings: {
    general: GeneralSettings;
    defaults: DefaultSettings;
    notifications: NotificationSettings;
    goals: GoalSettings;
    isDirty: boolean;
  };
  apiConnections: {
    ai: APIConnection[];
    video: APIConnection[];
    platform: APIConnection[];
    research: APIConnection[];
    image: APIConnection[];
  };
}

interface User {
  id: string;
  name: string;
  email: string;
  role: 'Owner' | 'Team' | 'Viewer';
  status: 'active' | 'invited' | 'disabled';
  permissions: string[];
  joinedAt: Date;
}

interface Client {
  id: string;
  companyName: string;
  contactPerson: string;
  email: string;
  phone?: string;
  plan: 'Basic' | 'Pro' | 'Enterprise';
  monthlyPrice: number;
  videoQuota: number;
  videosUsed: number;
  status: 'active' | 'onboarding' | 'paused';
  knowledgeId?: string;
  knowledgeStatus: 'pending' | 'in_progress' | 'completed';
  youtubeConnected: boolean;
  youtubeChannelName?: string;
  contractStartDate: Date;
}

interface APIConnection {
  id: string;
  name: string;
  type: 'ai' | 'video' | 'platform' | 'research' | 'image';
  status: 'connected' | 'disconnected' | 'error';
  apiKey?: string;
  endpoint?: string;
  usage?: {
    current: number;
    limit: number;
    unit: string;
  };
  lastTestedAt?: Date;
  testResult?: 'success' | 'failure';
}
```

## API連携

| エンドポイント | 用途 |
|--------------|------|
| GET /api/admin/users | ユーザー一覧 |
| POST /api/admin/users/invite | ユーザー招待 |
| PUT /api/admin/users/:id | ユーザー更新 |
| DELETE /api/admin/users/:id | ユーザー削除 |
| GET /api/admin/users/activity | アクティビティログ |
| GET /api/admin/clients | クライアント一覧 |
| POST /api/admin/clients | クライアント追加 |
| PUT /api/admin/clients/:id | クライアント更新 |
| DELETE /api/admin/clients/:id | クライアント削除 |
| GET /api/admin/settings | 設定取得 |
| PUT /api/admin/settings | 設定更新 |
| GET /api/admin/api-connections | API連携一覧 |
| PUT /api/admin/api-connections/:id | API設定更新 |
| POST /api/admin/api-connections/:id/test | API接続テスト |

## セキュリティ考慮事項

| 項目 | 対策 |
|-----|------|
| APIキー保存 | 暗号化して保存（AES-256） |
| APIキー表示 | マスク処理（末尾4文字のみ表示） |
| アクセス制御 | Ownerロールのみアクセス可能 |
| 監査ログ | 全ての設定変更を記録 |
| セッション | 管理画面は30分でタイムアウト |
