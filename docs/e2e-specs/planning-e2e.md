# 企画・計画ページ E2Eテスト仕様書

## 概要
企画・計画ページ（/planning）のE2Eテスト項目

## テスト環境
- フレームワーク: Playwright
- ブラウザ: Chrome, Firefox, Safari
- 解像度: 1920x1080, 1366x768, 375x667(mobile)

---

## 1. ページ遷移・初期表示

### 1.1 ページアクセス
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| P-001 | /planning にアクセス | ページが表示される |
| P-002 | 未認証でアクセス | /login にリダイレクト |
| P-003 | サイドバーから「企画」をクリック | /planning に遷移 |
| P-004 | ページタイトル確認 | 「企画」「アイデアを形にする」が表示 |

### 1.2 タブ表示
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| P-005 | タブが3つ表示される | 「コンテンツカレンダー」「企画一覧」「AI提案」 |
| P-006 | デフォルトタブ | 「コンテンツカレンダー」がアクティブ |
| P-007 | タブクリックで切り替え | 対応するコンテンツが表示 |
| P-008 | タブのアクティブ状態 | 選択中タブにアンダーライン表示 |

---

## 2. コンテンツカレンダータブ

### 2.1 カレンダー表示
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| CAL-001 | 月表示（デフォルト） | 当月のカレンダーが表示 |
| CAL-002 | 年月ヘッダー | 「2025年12月」形式で表示 |
| CAL-003 | 曜日ヘッダー | 日〜土が表示 |
| CAL-004 | 日付セル | 1〜末日が正しく配置 |
| CAL-005 | 今日の日付ハイライト | 背景色で強調表示 |

### 2.2 表示切り替え
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| CAL-006 | 「週表示」ボタンクリック | 週間ビューに切り替え |
| CAL-007 | 「月表示」ボタンクリック | 月間ビューに切り替え |
| CAL-008 | 「<」ボタンクリック | 前月/前週に移動 |
| CAL-009 | 「>」ボタンクリック | 翌月/翌週に移動 |
| CAL-010 | 「今日」ボタンクリック | 今日を含む月/週に移動 |

### 2.3 企画表示
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| CAL-011 | 公開済み企画 | 緑バッジで表示 |
| CAL-012 | 制作中企画 | 青バッジで表示 |
| CAL-013 | 企画中企画 | オレンジバッジで表示 |
| CAL-014 | 予定企画 | グレーバッジで表示 |
| CAL-015 | 複数企画の日 | 縦に並べて表示 |
| CAL-016 | ショート動画アイコン | 「ショート」タグ表示 |
| CAL-017 | 長尺動画アイコン | 「長尺」タグ表示 |

### 2.4 インタラクション
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| CAL-018 | 企画バッジクリック | 詳細ポップオーバー表示 |
| CAL-019 | 日付セルダブルクリック | （将来）企画作成モーダル |
| CAL-020 | 企画ドラッグ&ドロップ | 日付変更される |

---

## 3. 企画一覧タブ

### 3.1 フィルター
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| LIST-001 | ステータスフィルター表示 | 「全て」「予定」「企画中」「制作中」「公開済み」 |
| LIST-002 | 種類フィルター表示 | 「長尺」「ショート」 |
| LIST-003 | ステータス「公開済み」選択 | 公開済みのみ表示 |
| LIST-004 | 種類「ショート」選択 | ショートのみ表示 |
| LIST-005 | 複合フィルター | AND条件で絞り込み |

### 3.2 検索
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| LIST-006 | 検索ボックス表示 | プレースホルダー「企画を検索...」 |
| LIST-007 | キーワード入力 | リアルタイム絞り込み |
| LIST-008 | 検索クリア | 全件表示に戻る |
| LIST-009 | 該当なし | 「企画が見つかりません」表示 |

### 3.3 一覧テーブル
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| LIST-010 | カラムヘッダー | タイトル/種類/ステータス/公開予定/操作 |
| LIST-011 | 企画行表示 | 各カラムに情報表示 |
| LIST-012 | ステータスバッジ色 | 状態に応じた色 |
| LIST-013 | 種類バッジ | 「ショート」「長尺」表示 |
| LIST-014 | 日付フォーマット | YYYY/MM/DD形式 |

### 3.4 操作メニュー
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| LIST-015 | 「...」ボタンクリック | ドロップダウンメニュー表示 |
| LIST-016 | 「詳細を見る」 | 詳細モーダル/ページ表示 |
| LIST-017 | 「編集」 | 編集モード |
| LIST-018 | 「台本作成へ」 | /script ページへ遷移 |
| LIST-019 | 「削除」 | 確認ダイアログ表示 |
| LIST-020 | 削除確認「はい」 | 企画削除、一覧更新 |

---

## 4. AI提案タブ

### 4.1 初期表示
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| AI-001 | レイアウト | 左65%チャット、右35%採用済み |
| AI-002 | ナレッジ選択ドロップダウン | 利用可能なナレッジ一覧 |
| AI-003 | AIアシスタント初期メッセージ | ウェルカムメッセージ表示 |
| AI-004 | 入力エリア | テキストエリア + 送信ボタン |
| AI-005 | 採用済みパネル | 「採用した企画」ヘッダー |

### 4.2 チャット機能
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| AI-006 | メッセージ入力 | テキスト入力可能 |
| AI-007 | 送信ボタンクリック | メッセージ送信 |
| AI-008 | Enter + Shift で改行 | 改行される |
| AI-009 | Enter で送信 | メッセージ送信 |
| AI-010 | 空メッセージ送信 | 送信ボタン無効 |
| AI-011 | ユーザーメッセージ表示 | 右寄せ、青背景 |
| AI-012 | AIメッセージ表示 | 左寄せ、グレー背景 |
| AI-013 | AIアイコン表示 | メッセージ横にアイコン |
| AI-014 | 送信中インジケーター | ローディング表示 |
| AI-015 | メッセージスクロール | 新メッセージで自動スクロール |

### 4.3 提案カード
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| AI-016 | 提案カード表示 | AIメッセージ内にカード |
| AI-017 | タイトル表示 | 提案タイトル |
| AI-018 | 説明表示 | 提案の概要 |
| AI-019 | タグ表示 | 関連タグ |
| AI-020 | 種類バッジ | ショート/長尺 |
| AI-021 | 「採用する」ボタン | クリック可能 |

### 4.4 提案採用
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| AI-022 | 「採用する」クリック | 採用確認モーダル |
| AI-023 | 公開日選択 | カレンダーで日付選択可能 |
| AI-024 | タイトル編集 | 採用時にタイトル変更可能 |
| AI-025 | 採用確定 | 採用済みパネルに追加 |
| AI-026 | 採用済みカード表示 | タイトル + 公開予定日 |
| AI-027 | 「取り消す」ボタン | 採用取り消し確認 |
| AI-028 | 取り消し確定 | パネルから削除 |

### 4.5 ナレッジ連携
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| AI-029 | ナレッジ選択 | AI応答にナレッジ反映 |
| AI-030 | ナレッジ参照表示 | 「〇〇ナレッジを参照」表示 |
| AI-031 | ナレッジ未選択 | 汎用的な提案 |

---

## 5. テーマ対応

### 5.1 ダークモード
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| TH-001 | カレンダー背景 | ダーク背景に切り替え |
| TH-002 | テーブル背景 | ダーク背景 |
| TH-003 | チャットエリア | ダーク背景 |
| TH-004 | テキスト色 | 白/グレー系に変更 |
| TH-005 | ボーダー色 | 適切なコントラスト |
| TH-006 | バッジ色 | 視認性維持 |

### 5.2 ライトモード
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| TH-007 | カレンダー背景 | ライト背景 |
| TH-008 | テーブル背景 | ライト背景 |
| TH-009 | チャットエリア | ライト背景 |
| TH-010 | テキスト色 | 黒/グレー系 |

---

## 6. レスポンシブ対応

### 6.1 タブレット（1024px以下）
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| RES-001 | カレンダー | 列幅調整 |
| RES-002 | AI提案レイアウト | 縦並びに変更 |
| RES-003 | テーブルスクロール | 横スクロール可能 |

### 6.2 モバイル（768px以下）
| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| RES-004 | カレンダー | 日付のみ表示 |
| RES-005 | 企画一覧 | カード形式に変更 |
| RES-006 | チャット | 全幅表示 |
| RES-007 | 採用済みパネル | 下部に移動 |

---

## 7. エラーハンドリング

| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| ERR-001 | API接続エラー | エラーメッセージ表示 |
| ERR-002 | タイムアウト | リトライオプション表示 |
| ERR-003 | AI生成失敗 | 「再試行」ボタン表示 |
| ERR-004 | 権限エラー | アクセス拒否メッセージ |

---

## 8. パフォーマンス

| ID | テスト項目 | 期待結果 |
|----|----------|---------|
| PERF-001 | 初期表示 | 2秒以内 |
| PERF-002 | タブ切り替え | 500ms以内 |
| PERF-003 | フィルター適用 | 300ms以内 |
| PERF-004 | チャット応答開始 | 1秒以内 |
| PERF-005 | カレンダー月切り替え | 500ms以内 |

---

## テスト実行コマンド

```bash
# 全テスト実行
npx playwright test planning

# 特定カテゴリ実行
npx playwright test planning --grep "カレンダー"

# ビジュアルテスト
npx playwright test planning --grep "スナップショット"

# デバッグモード
npx playwright test planning --debug
```

---

## テスト項目サマリー

| カテゴリ | 項目数 |
|---------|--------|
| ページ遷移・初期表示 | 8 |
| コンテンツカレンダー | 20 |
| 企画一覧 | 20 |
| AI提案 | 31 |
| テーマ対応 | 10 |
| レスポンシブ | 7 |
| エラーハンドリング | 4 |
| パフォーマンス | 5 |
| **合計** | **105** |
